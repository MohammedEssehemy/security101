import CustomHeader from '../layout/CustomHeader';
import customTheme from '../layout/theme';
export const theme = customTheme

<Header>
    <CustomHeader />
</Header>

# Security 101
<center>Essehemy üëã</center>

---
<Header>
    <CustomHeader />
</Header>

## Cyber Security üë®üèª‚Äçüíª


<center> Process and preventative action of protecting computer systems
            from malicious attacks or unauthorized access </center>


---
<Header>
    <CustomHeader />
</Header>


<center> Cyber-Security is much more than a matter of IT </center>

---

<Header>
    <CustomHeader />
</Header>

##### Everything relies on computers

- Communication 
- Medicine 
- Education
- Military
- Transportation
- Shopping 

---

<Header>
    <CustomHeader />
</Header>

<h3>
<center> It takes 20 years to build a reputation and few minutes of cyber-incident to ruin it </center>
</h3>

---

import ReactImageMagnify from 'react-image-magnify';
import securityImage from "../images/node.js_security_infographics.png";

<Header>
    <CustomHeader />
</Header>

##### How are we doing regarding security?ü•¥

<ReactImageMagnify  
smallImage={{
    src: securityImage,
    alt: 'Node.js security infographics',
    width: 300,
    height: 600
    }} 
largeImage={{
    src: securityImage,
    width: 550,
    height: 2400
}}
isHintEnabled={true}
shouldHideHintAfterFirstActivation={false}
enlargedImageContainerDimensions={{width: 550, height: 500}}
/>

---

<Header>
    <CustomHeader />
</Header>

#### Elements

- Information Security
- Network Security
- End User Education
- Application Security

---

import informationSecurityImage from "../images/principles_of_information_security.jpg";

<Header>
    <CustomHeader />
</Header>

#### Principles of  Information Security (CIA)

<img width="40%" src={informationSecurityImage} />

---

<Header>
    <CustomHeader />
</Header>

### Network Security 

- Use Virtual Private Network (VPN)
- Apply Network Access Control (NAC)
- Apply Firewall Rules
- Watch out of MITM and spoofing

---

<Header>
    <CustomHeader />
</Header>

### End User Education üôÜüèª‚Äç‚ôÇÔ∏è

- Humans are the weakest link in a security system
- Security policies, procedures and protocols must be applied
- Be aware of Social Engineering
- Take care of Phishing & Scams

---

<Header>
    <CustomHeader />
</Header>

<h3>
<center> üëâüèª You are the most important factor </center>
</h3>

---

<Header>
    <CustomHeader />
</Header>

<center> Security in IT is like locking your house or car, 
    it doesn‚Äôt stop the bad guys, but if it‚Äôs good enough they may move on to an easier target </center>

---

<Header>
    <CustomHeader />
</Header>

import owaspImage from "../images/owasp.png";

## Application Security

<img src={owaspImage} />

---

<Header>
    <CustomHeader />
</Header>

## OWASP Top 10 üêû

<center> The 10 most critical web application security risks, as identified and agreed upon, 
    by security experts from around the world. </center>

---

<Header>
    <CustomHeader />
</Header>

import riskImage from "../images/risk.png";

## Risk? ‚ö†Ô∏è

<img src={riskImage} />

---

<Header>
    <CustomHeader />
</Header>

import injectionImage from "../images/injection.jpg";

## A1:2017 - Injection 

<img src={injectionImage} />

---

<Header>
    <CustomHeader />
</Header>

- The attacker‚Äôs hostile data can trick the interpreter into executing unintended commands 
or accessing data without proper authorization 
- User-supplied data is not validated, filtered, or sanitized by the application 
- Most common types are `SQL`, `NoSQL`

---

<Header>
    <CustomHeader />
</Header>

### Mitigation üíâ

- Use a safe API, which avoids the use of the interpreter entirely or provides a parameterized interface 
- Use positive list (allowed values)
- Escape special characters using context aware interpreter
- Reduce dynamic queries
- Code Review
- [SAST](https://owasp.org/www-community/Source_Code_Analysis_Tools) and [DAST](https://owasp.org/www-community/Vulnerability_Scanning_Tools)

---

<Header>
    <CustomHeader />
</Header>

import brokenAuthenticationImage from "../images/Broken_Authentication.png";

## A2:2017 - Broken Authentication üîì

<img src={brokenAuthenticationImage} />


---

<Header>
    <CustomHeader />
</Header>

- Authentication and session management are often implemented incorrectly, allowing attackers to take-over other users‚Äô identities temporarily or permanently 
- Uses weak or ineffective credential recovery and forgot-password processes  
- Uses plain text, encrypted, or weakly hashed passwords 
- Has missing or ineffective multi-factor authentication

---

<Header>
    <CustomHeader />
</Header>

### Mitigation üíâ

- Implement multi-factor authentication to prevent credential stuffing and brute force attacks
- Change default credentials, particularly for admin users 
- Ensure rate limit and apply exponential backoff
- User sessions or authentication tokens should be invalidated during logout or a period of inactivity

---

import sensitiveDataExposureImage from '../images/SensitiveDataExposure.jpg';

<Header>
    <CustomHeader />
</Header>


## A3:2017 - Sensitive Data Exposure ü§ê

<img width={'80%'} height={'40%'} src={sensitiveDataExposureImage} />

---

<Header>
    <CustomHeader />
</Header>

- Many web applications and APIs do not properly protect sensitive data, such as financial, healthcare, and PII. 
- Data transmitted in clear text? protocols such as HTTP, SMTP, and FTP (in transit)
- Is sensitive data stored in clear text, including backups? (at rest)
- are any user agent (browser) security directives or headers missing?

---

<Header>
    <CustomHeader />
</Header>

## Mitigation üíâ

- Identify which data is sensitive according to laws, or business needs
- Don‚Äôt store sensitive data unnecessarily
- Encrypt all data in transit with secure protocols such as TLS
- Use [HSTS - HTTP Strict Transport Security](https://cheatsheetseries.owasp.org/cheatsheets/HTTP_Strict_Transport_Security_Cheat_Sheet.html)
- Disable caching for responses that contain sensitive data

---

import XXEImage from '../images/XML_External_Entities.png';

<Header>
    <CustomHeader />
</Header>


## A4:2017 - XML External Entities  

<img src={XXEImage} />


---

<Header>
    <CustomHeader />
</Header>

- Many older or poorly configured XML processors evaluate external entity references within XML documents. 
External entities can be used to disclose internal files using the file URI handler, internal file shares, internal port scanning, remote code execution, and denial of service attacks

- use less complex data formats such as JSON, and avoiding serialization of sensitive data

---

import accessControlImage from '../images/Access_Control.png';

<Header>
    <CustomHeader />
</Header>

## A5:2017 - Broken Access Control

<img src={accessControlImage} />


---

<Header>
    <CustomHeader />
</Header>

### Symptoms

- Restrictions on what authenticated users are allowed to do are often not properly enforced. (Authorization) 
- Attackers can exploit it to access unauthorized functionality and/or data
- Elevation of privilege, acting as an admin when logged in as a normal user
- It is only effective if enforced in trusted server-side code, where the attacker cannot modify it

---

import clientSideOnlyValidationImage from '../images/client_side_only_validation.png';

<Header>
    <CustomHeader />
</Header>

<img width="40%" src={clientSideOnlyValidationImage} />

---


<Header>
    <CustomHeader />
</Header>

### Mitigation

- Deny by default - Least required privilege
- Enforce record ownership, rather than accepting that the user can create, read, update, or delete any record
- Log access control failures, alert admins when appropriate (e.g. repeated failures)
- JWT tokens should be invalidated on the server after logout


---

import misconfigurationsImage from '../images/Misconfigurations.png';

<Header>
    <CustomHeader />
</Header>

### A6:2017 - Security Misconfiguration

<img src={misconfigurationsImage} />


---


<Header>
    <CustomHeader />
</Header>

- Security misconfiguration is the most commonly seen issue
- This is commonly a result of insecure default configurations, incomplete or ad hoc configurations, open cloud storage, misconfigured CORS and HTTP headers, and verbose error messages containing sensitive information
- Missing appropriate security hardening across any part of the application stack

---

import xssImage from '../images/xss.jpg';

<Header>
    <CustomHeader />
</Header>

## A7:2017 - Cross-Site Scripting (XSS)

<img src={xssImage} />


---


<Header>
    <CustomHeader />
</Header>

- Occurs whenever an application includes untrusted data in a new web page without proper validation or escaping
- Allows attackers to execute scripts in the victim‚Äôs browser which can hijack user sessions or visit malicious sites
- Include session stealing, account takeover, MFA bypass, malicious software downloads, key logging, ...

---

<Header>
    <CustomHeader />
</Header>

### XSS types

- DOM XSS (Type 0): The entire tainted data flow from source to sink takes place in the browser.
- Stored XSS (Type I): The application or API stores unsanitized user input that is viewed at a later time by another user
- Reflected XSS (Type II): user input is immediately returned by a web application in an error message, search result, or any other response without sanitization.


---


<Header>
    <CustomHeader />
</Header>

### Mitigation

- Using frameworks that automatically escape XSS by design
- Context-aware escaping of untrusted HTTP request data
- Apply strict [Content-Securit-Policy - CSP](https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP)
- Use automated tools such as WAF (Web Application Firewall)

---

import insecureDeserializationImage from '../images/insecure_deserialization.jpg';

<Header>
    <CustomHeader />
</Header>

## A8:2017 - Insecure Deserialization

<img width="50%" src={insecureDeserializationImage} />

---


<Header>
    <CustomHeader />
</Header>

- Insecure deserialization often leads to RCE - remote code execution
- Prototype pollution and application logic modification
- Data tampering attacks

---

<Header>
    <CustomHeader />
</Header>

### Mitigation

- Try not to accept serialized objects from untrusted sources
- Enforcing strict type constraints during deserialization before object creation
- Isolating and running code that deserializes in low privilege
- Logging deserialization exceptions and failures
- Implementing integrity checks on serialized objects

---

import componentsWithKnownVulnsImage from '../images/comp_known_vulns.png';

<Header>
    <CustomHeader />
</Header>

##### A9:2017 - Using Components with Known Vulnerabilities

<img width="60%" src={componentsWithKnownVulnsImage} />

---

<Header>
    <CustomHeader />
</Header>

- Only obtain components from official sources over secure links
- Upgrade periodically and perform automated sanity checks
- Remove unused dependencies, unnecessary features, components, files, and documentation
- Monitor for libraries and components that are unmaintained

---

import logMoitoringImage from '../images/log-monitoring.png';

<Header>
    <CustomHeader />
</Header>

##### A10:2017 - Insufficient Logging & Monitoring

<img src={logMoitoringImage} />

---

<Header>
    <CustomHeader />
</Header>

<center> What You Cannot See, You Cannot Fight </center>

---

<Header>
    <CustomHeader />
</Header>

- Insufficient logging and monitoring, allows attackers to further attack systems, maintain persistence, and tamper, extract, or destroy data. 
- Most breach studies show time to detect a breach is over 200 days, typically detected by external parties rather than internal processes or monitoring
- It is the bedrock of nearly every major incident

---


<Header>
    <CustomHeader />
</Header>

## Mitigation

- Ensure all login, access control failures, and server-side input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts
- Use centralized log management solutions
- Establish effective monitoring and alerting such that suspicious activities are detected and responded to in a timely fashion

---

<Header>
    <CustomHeader />
</Header>


<center> it is far more cost effective to design the security in from the start </center>



---

import allInOneImage from '../images/all-in-one.jpg';

<Header>
    <CustomHeader />
</Header>

<ReactImageMagnify  
smallImage={{
    src: allInOneImage,
    alt: 'OWASP Top 10 all in one',
    width: 300,
    height: 625
    }} 
largeImage={{
    src: allInOneImage,
    width: 650,
    height: 3400
}}
isHintEnabled={true}
shouldHideHintAfterFirstActivation={false}
enlargedImageContainerDimensions={{width: 650, height: 600}}
/>


---

import CSRFImage from '../images/CSRF.png'

<Header>
    <CustomHeader />
</Header>

#### A8:2013 - Cross-Site Request Forgery (CSRF)

<img width="70%" src={CSRFImage} />

---


<Header>
    <CustomHeader />
</Header>

- A CSRF attack forces a logged-on victim‚Äôs browser to send a forged HTTP request, including the victim‚Äôs session cookie and any other automatically included authentication information, to a vulnerable web application
- Use X-CSRF token
- Requiring the user to reauthenticate, or prove they are a user (e.g., via a CAPTCHA) can also protect against CSRF



---

import unvalidatedRedirectImage from '../images/unvalidated_redirects.jpeg';

<Header>
    <CustomHeader />
</Header>

#### A10: 2013 ‚Äì Unvalidated Redirects and Forwards


<img src={unvalidatedRedirectImage} />

---


<Header>
    <CustomHeader />
</Header>

- Web applications frequently redirect and forward users to other pages and websites, and use untrusted data to determine the destination pages. Without proper validation, attackers can redirect victims to phishing or malware sites, or use forwards to access unauthorized pages
- Don‚Äôt involve user parameters in calculating the destinatio
- Whitelist allowed domains

---

<Header>
    <CustomHeader />
</Header>

<h3>
<center>
If you think you know-it-all about cybersecurity, 
this discipline was probably ill-explained to you
</center>
</h3>

---

<Header>
    <CustomHeader />
</Header>

### References üìö

- [OWASP TOP 10 - 2013 PDF](https://github.com/OWASP/Top10/blob/master/2013/OWASP%20Top%2010%20-%202013.pdf)
- [OWASP TOP 10 - 2017](https://github.com/OWASP/Top10/blob/master/2017/OWASP%20Top%2010-2017%20(en).pdf)
- [OWASP - Vulnerable Web Applications Directory](https://owasp.org/www-project-vulnerable-web-applications-directory/)
- Vulnerable apps for Ninjas to exploit üïµüèª‚Äç‚ôÇÔ∏è
    - [Juice Shop](https://github.com/bkimminich/juice-shop)
    - [Node Goat](https://github.com/OWASP/NodeGoat)
- [Awesome nodejs security](https://github.com/lirantal/awesome-nodejs-security)
- [Nodejs Security status infographic](https://i1.wp.com/blog.sqreen.com/wp-content/uploads/2017/11/node.js_security_infographics.png?w=1024)

---

<Header>
    <CustomHeader />
</Header>

### continue

- [OWASP Top 10 - 2017 Infographic](https://www.veracode.com/sites/default/files/owasp-top-10-update-2017-infographic.png)
- [NodeJS security cheat sheet](https://cheatsheetseries.owasp.org/cheatsheets/Nodejs_Security_Cheat_Sheet.html)
- [CWE Top 25](https://cwe.mitre.org/data/definitions/1350.html)
- I‚Äôm harvesting credit card numbers and passwords from your site. Here‚Äôs how ([part 1](https://medium.com/hackernoon/im-harvesting-credit-card-numbers-and-passwords-from-your-site-here-s-how-9a8cb347c5b5), [Part 2](https://medium.com/hackernoon/part-2-how-to-stop-me-harvesting-credit-card-numbers-and-passwords-from-your-site-844f739659b9))
- [A post-mortem of the malicious event-stream backdoor](https://snyk.io/blog/a-post-mortem-of-the-malicious-event-stream-backdoor/)
- [CSRF](https://owasp.org/www-community/attacks/csrf)
- [CORS](https://developer.mozilla.org/en-US/docs/Web/HTTP/CORS)


---

<Header>
    <CustomHeader />
</Header>

## Thank you 
### üëãüëã